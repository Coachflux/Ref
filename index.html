<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Mining Savi</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
<style>
  /* simplified styling omitted for brevity â€” same as before */
</style>
</head>
<body>
<header>Mining Savi</header>
<div class="card">
  <div class="calendar-icon" onclick="toggleCalendar()"><i class="fa-solid fa-calendar-days"></i></div>
  <div class="balance" id="balance">$0.00</div>
  <div class="rank-section">
    <div class="rank" id="rank">Rank: Starter</div>
    <div class="rank-bar"><div id="rankProgress" class="rank-bar-fill"></div></div>
    <div class="view-rank" onclick="showRankDetails()">View Rank Progress</div>
  </div>
</div>
<div id="calendarPopup" class="calendar-popup">
  <i class="fa-solid fa-times close-btn" onclick="toggleCalendar()"></i>
  <strong>Mined Days</strong><br><div id="minedDates"></div>
</div>
<div class="circle-meter">
  <div class="countdown-overlay">
    <div id="countdown">24:00:00</div>
    <div id="mined">+0.00000</div>
  </div>
</div>
<button class="mine-button" onclick="startMining()">Mine now!</button>
<audio id="miningSound" src="https://www.fesliyanstudios.com/play-mp3/387" preload="auto"></audio>
<script>
(function(){
  const DURATION = 24*3600*1000, RATE = 0.00002;
  let interval=0, startTime=0, baseBal=0;

  const balanceEl = document.getElementById('balance'),
        countdownEl = document.getElementById('countdown'),
        minedEl = document.getElementById('mined'),
        rankEl = document.getElementById('rank'),
        rankBar = document.getElementById('rankProgress'),
        minedDatesEl = document.getElementById('minedDates'),
        calendarEl = document.getElementById('calendarPopup'),
        sound = document.getElementById('miningSound');

  function get(date) { return localStorage.getItem(date); }
  function today() { return new Date().toISOString().split('T')[0]; }
  function getBal(){ return parseFloat(get('balance')||'0'); }
  function setBal(v){ localStorage.setItem('balance',v.toFixed(6)); balanceEl.textContent=`$${v.toFixed(2)}`; }
  function getDays(){ return JSON.parse(get('days')||'[]'); }
  function addDay(){let d=getDays();const t=today();if(!d.includes(t)){d.push(t);localStorage.setItem('days',JSON.stringify(d));}}
  
  function updateRank(){
    const d=getDays().length, pct=d>=90?100:d>=60?(d-60)/30*100:d>=30?(d-30)/30*100:d/30*100;
    const name=d>=90?'Supreme':d>=60?'Elite':d>=30?'Pioneer':'Starter';
    rankEl.textContent=`Rank: ${name}`; rankBar.style.width=`${pct}%`;
  }
  function showRankDetails(){
    const d=getDays().length;
    let rem = d<30?30-d:d<60?60-d:d<90?90-d:0;
    alert(`${d} day(s) mined\nNext: ${rem} days`);
  }
  function giveBonus(){
    const d = getDays(), tArr=[];
    for(let i=0;i<7;i++){let dt=new Date();dt.setDate(dt.getDate()-i);tArr.push(dt.toISOString().split('T')[0]);}
    let streak=0, bonus=0;
    tArr.forEach(x=> { if(d.includes(x)){ streak++; if(streak===2)bonus+=0.05; if(streak===5)bonus+=0.5 } else streak=0; });
    if(bonus){
      setTimeout(()=>alert("ðŸŽ‰ Congratulations, your hard work is paying off."),100);
      setBal(getBal()+bonus);
    }
  }
  function format(ms){const s=Math.floor(ms/1000), h=Math.floor(s/3600), m=Math.floor((s%3600)/60), sec=s%60;
    return [h,m,sec].map(n=>String(n).padStart(2,'0')).join(':');
  }
  function tick(){
    const now=Date.now(), el=now-startTime;
    if(el>=DURATION){
      clearInterval(interval); countdownEl.textContent='00:00:00'; minedEl.textContent='+1.72800';
      setBal(baseBal+1.728); addDay(); giveBonus(); updateRank();
      localStorage.removeItem('startTime');
      return;
    }
    countdownEl.textContent = format(DURATION - el);
    const earned = Math.floor(el/1000)*RATE;
    minedEl.textContent = `+${earned.toFixed(5)}`;
    setBal(baseBal + earned);
  }
  window.startMining = function(){
    if(get('startTime')) return;
    sound.play(); startTime=Date.now(); baseBal=getBal();
    localStorage.setItem('startTime',startTime);
    interval = setInterval(tick,1000);
  };
  window.toggleCalendar = function(){
    const d=getDays(), t=today();
    minedDatesEl.innerHTML = d.map(x=> x==(t)? `${x} âœ…`:`${x}`).join('<br>');
    calendarEl.style.display = calendarEl.style.display==='block'?'none':'block';
  };
  window.onload = function(){
    setBal(getBal()); updateRank();
    const st=parseInt(get('startTime'));
    if(st){
      startTime=st; baseBal = getBal() - Math.floor((Date.now()-st)/1000)*RATE;
      sound.play(); interval = setInterval(tick,1000);
    }
  };
})();
</script>
</body>
</html>
