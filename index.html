<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Mining Savi</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <style>
    *{box-sizing:border-box}
    body{margin:0;background:#052820;color:#fff;font-family:'Segoe UI';padding-bottom:6rem}
    header{width:100%;padding:1rem;text-align:center;background:#052828;font-size:1.5rem}
    .card{background:#f0ffff;color:#041c1c;border-radius:2rem;box-shadow:-10px -10px 30px #fff,10px 10px 30px rgba(0,255,200,0.3);padding:1.5rem;width:90%;max-width:400px;margin:1rem auto;position:relative}
    .calendar-icon{position:absolute;top:10px;right:15px;font-size:1.4rem;color:#00c896;cursor:pointer}
    .calendar-popup{display:none;position:fixed;top:80px;left:10%;width:80%;background:#fff;color:#000;padding:1rem;border-radius:1rem;z-index:999;box-shadow:0 0 10px rgba(0,255,200,0.5);max-height:60vh;overflow-y:auto}
    .close-btn{position:absolute;top:8px;right:8px;cursor:pointer;font-size:1.2rem}
    .balance{font-size:2rem;font-weight:bold;color:#00aa88}
    .rank-section{margin-top:0.5rem}
    .rank{font-weight:bold}
    .rank-bar{background:#ccc;border-radius:10px;overflow:hidden;height:10px;margin-top:0.5rem}
    .rank-bar-fill{height:100%;background:linear-gradient(to right,#00ffcc,#00aa88);width:0%}
    .circle-meter{width:200px;height:200px;border-radius:50%;background:url('https://upload.wikimedia.org/wikipedia/commons/3/3f/Tether_Logo.svg') center/cover no-repeat;margin:1rem auto;position:relative}
    .countdown-overlay{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(255,255,255,0.85);padding:0.5rem 1rem;border-radius:10px;color:#041c1c;text-align:center}
    .mine-button{background:linear-gradient(90deg,#00c896,#00ffb3);border:none;padding:1rem;border-radius:10px;color:#041c1c;font-size:1.2rem;width:90%;max-width:400px;display:block;margin:1rem auto;cursor:pointer}
    .nav-bar{position:fixed;bottom:0;left:0;right:0;background:#031e1e;padding:0.5rem 1rem;display:flex;justify-content:space-around;border-top-left-radius:2rem;border-top-right-radius:2rem}
    .nav-icon{color:#9debdc;display:flex;flex-direction:column;align-items:center}
    .nav-icon.active{color:#00ffc8}
    .missed{color:#f44336;font-weight:bold}
    @media(max-width:480px){.circle-meter{width:160px;height:160px}}
  </style>
</head>
<body>
<header>Mining Savi</header>

<div class="card">
  <div class="calendar-icon" onclick="toggleCalendar()"><i class="fa-solid fa-calendar-days"></i></div>
  <div class="balance" id="balance">$0.00</div>
  <div class="rank-section">
    <div class="rank" id="rank">Rank: Starter</div>
    <div class="rank-bar"><div class="rank-bar-fill" id="rankProgress"></div></div>
  </div>
</div>

<div class="calendar-popup" id="calendarPopup">
  <i class="fa-solid fa-times close-btn" onclick="toggleCalendar()"></i>
  <strong>Mined Days</strong><br>
  <div id="minedDates"></div>
</div>

<div class="circle-meter">
  <div class="countdown-overlay">
    <div id="countdown">24:00:00</div>
    <div id="mined">+0.00000</div>
  </div>
</div>

<button class="mine-button" onclick="startMining()">Mine now!</button>

<div class="nav-bar">
  <div class="nav-icon"><i class="fa-solid fa-gift"></i><div>Airdrop</div></div>
  <div class="nav-icon"><i class="fa-solid fa-user-group"></i><div>Referral</div></div>
  <div class="nav-icon active"><i class="fa-solid fa-hammer"></i><div>Mine</div></div>
  <div class="nav-icon"><i class="fa-solid fa-newspaper"></i><div>News</div></div>
  <div class="nav-icon"><i class="fa-solid fa-gear"></i><div>Settings</div></div>
</div>

<audio id="miningSound" src="https://www.fesliyanstudios.com/play-mp3/387" preload="auto"></audio>

<script>
(function(){
  const DURATION = 86400000; // 24 hrs in ms
  const RATE = 0.00002; // per second
  let interval = null;
  let startTime = 0;
  let lastEarned = 0;

  const balanceEl = document.getElementById('balance'),
        countdownEl = document.getElementById('countdown'),
        minedEl = document.getElementById('mined'),
        rankEl = document.getElementById('rank'),
        rankBar = document.getElementById('rankProgress'),
        minedDatesEl = document.getElementById('minedDates'),
        calendarEl = document.getElementById('calendarPopup'),
        sound = document.getElementById('miningSound');

  function getTodayStr() {
    return new Date().toISOString().split('T')[0];
  }

  function getBalance() {
    return parseFloat(localStorage.getItem('balance') || '0');
  }

  function setBalance(val) {
    localStorage.setItem('balance', val.toFixed(6));
    balanceEl.textContent = `$${val.toFixed(2)}`;
  }

  function getMinedDays() {
    return JSON.parse(localStorage.getItem('days') || '[]');
  }

  function addMinedDay() {
    const days = getMinedDays();
    const today = getTodayStr();
    if (!days.includes(today)) {
      days.push(today);
      localStorage.setItem('days', JSON.stringify(days));
    }
  }

  function updateRank() {
    const count = getMinedDays().length;
    let rank = 'Starter', percent = (count / 30) * 100;
    if (count >= 90) { rank = 'Supreme'; percent = 100; }
    else if (count >= 60) { rank = 'Elite'; percent = ((count - 60) / 30) * 100; }
    else if (count >= 30) { rank = 'Pioneer'; percent = ((count - 30) / 30) * 100; }
    rankEl.textContent = `Rank: ${rank}`;
    rankBar.style.width = `${Math.min(100, percent)}%`;
  }

  function format(ms) {
    const total = Math.floor(ms / 1000);
    const h = String(Math.floor(total / 3600)).padStart(2, '0');
    const m = String(Math.floor((total % 3600) / 60)).padStart(2, '0');
    const s = String(total % 60).padStart(2, '0');
    return `${h}:${m}:${s}`;
  }

  function tick() {
    const now = Date.now();
    const elapsed = now - startTime;
    const remaining = DURATION - elapsed;
    if (remaining <= 0) {
      clearInterval(interval);
      minedEl.textContent = '+1.72800';
      countdownEl.textContent = '00:00:00';
      const newBalance = getBalance() + 1.728;
      setBalance(newBalance);
      addMinedDay();
      updateRank();
      localStorage.removeItem('startTime');
      return;
    }
    const earned = Math.floor(elapsed / 1000) * RATE;
    minedEl.textContent = `+${earned.toFixed(5)}`;
    setBalance(lastEarned + earned);
    countdownEl.textContent = format(remaining);
  }

  window.startMining = function() {
    if (localStorage.getItem('startTime')) return;
    sound.play();
    startTime = Date.now();
    lastEarned = getBalance();
    localStorage.setItem('startTime', startTime.toString());
    interval = setInterval(tick, 1000);
  };

  window.toggleCalendar = function() {
    const days = getMinedDays();
    const today = getTodayStr();
    minedDatesEl.innerHTML = days.map(d => `${d} ${d === today ? 'âœ…' : ''}`).join('<br>');
    calendarEl.style.display = calendarEl.style.display === 'block' ? 'none' : 'block';
  };

  window.onload = function() {
    setBalance(getBalance());
    updateRank();
    const storedStart = parseInt(localStorage.getItem('startTime'));
    if (storedStart) {
      startTime = storedStart;
      lastEarned = getBalance() - Math.floor((Date.now() - storedStart) / 1000) * RATE;
      interval = setInterval(tick, 1000);
    }
  };
})();
</script>
</body>
</html>
